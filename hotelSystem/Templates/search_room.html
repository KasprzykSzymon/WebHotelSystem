{% extends 'base.html' %}

{% block header %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/styles_search_room.css' %}">
    <title>Wyszukiwanie pokoi</title>
{% endblock %}

{% block content %}
<div class="main-container">
    <!-- Formularz z filtrami -->
    <aside class="filters">
        <h3>Filtry</h3>
        <form method="GET" action="">
            <label for="arrival_date">Data przyjazdu:</label>
            <input type="date" id="arrival_date" name="arrival_date" value="{{ arrival_date }}">

            <label for="departure_date">Data odjazdu:</label>
            <input type="date" id="departure_date" name="departure_date" value="{{ departure_date }}">

            <label for="room-type">Typ pokoju:</label>
            <select id="room-type" name="room_type">
                <option value="">Wszystkie</option>
                <option value="single" {% if room_type == 'single' %}selected{% endif %}>Jednoosobowy</option>
                <option value="double" {% if room_type == 'double' %}selected{% endif %}>Dwuosobowy</option>
                <option value="suite" {% if room_type == 'suite' %}selected{% endif %}>Apartament</option>
            </select>
            
            <label for="min-price">Cena minimalna:</label>
            <input type="number" id="min-price" name="min_price" placeholder="Minimalna" value="{{ min_price }}">

            <label for="max-price">Cena maksymalna:</label>
            <input type="number" id="max-price" name="max_price" placeholder="Maksymalna" value="{{ max_price }}">

            <button type="submit" class="lokalizacja-button">Filtruj</button>
        </form>
    </aside>

    <div class="rooms-list">
        <h1>Wyniki wyszukiwania pokoi</h1>

        <!-- Wyświetlanie komunikatu o błędzie -->
        {% if error_message %}
            <div class="error-message">
                <p>{{ error_message }}</p>
            </div>
        {% endif %}

        <p>Data przyjazdu: {{ arrival_date }}</p>
        <p>Data odjazdu: {{ departure_date }}</p>
        <p>Liczba dorosłych: {{ adults }}</p>
        <p>Liczba dzieci: {{ children }}</p>

        {% if rooms %}
            {% for room in rooms %}
            <div class="room">
                {% if room.images.first %}
                    <img src="{{ room.images.first.image.url }}" alt="Image for {{ room.name }}" class="lokalizacja-img">
                {% else %}
                    <img src="{% static 'images/default-room.jpg' %}" alt="Default room image" class="lokalizacja-img">
                {% endif %}
                <div class="room-info">
                    <h3>Pokój {{ room.number }} - {{ room.get_room_type_display }}</h3>
                    <p><strong>Cena za noc: </strong>{{ room.price_per_night }} zł</p>
                    <p><strong>Pojemność: </strong>{{ room.capacity }} osób</p>
                    <a href="{% url 'room_detail' room.id %}" class="lokalizacja-button">Zobacz szczegóły</a>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p>Nie znaleziono pokoi spełniających podane kryteria.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
